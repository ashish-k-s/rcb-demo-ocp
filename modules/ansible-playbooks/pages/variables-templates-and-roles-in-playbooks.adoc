#  Variables, templates, and roles in playbooks

- # Variables, Templates, and Roles in Playbooks

  Ansible playbooks are written in YAML, a human-readable data serialization language. They allow you to describe the desired state of your systems in a simple, yet powerful way. In this section, we will explore variables, templates, and roles – essential elements that enhance playbooks' flexibility and reusability.

## Variables

Variables in Ansible playbooks store configuration data that can be reused throughout your playbook or shared across multiple playbooks. This helps maintain consistency and simplifies management by reducing redundancy. Here's how to declare and use variables:

  **Declaration**

  Declare variables at the top-level of a playbook, inside the `vars` key:

  ```yaml
  ---
  - name: Playbook for managing users
    hosts: all
    vars:
      user_name: "john"
      user_group: "admin"
  ```

  **Usage**

  Refer to variables within tasks using Jinja2 syntax (`{{ variable_name }}`):

  ```yaml
  - name: Ensure the user exists
    user:
      name: "{{ user_name }}"
      groups: "{{ user_group }}"
      state: present
  ```

## Templates

Templates in Ansible enable you to generate configuration files dynamically by merging a base template with variables. This allows for more flexible and reusable configurations. Here's how to use templates:

  **Creating a Template**

  Create a Jinja2-based template file (e.g., `myconfig.j2`) with placeholders for variable substitution:

  ```
  # myconfig.j2
  [service]
  interface={{ network_interface }}
  ```

  **Using Templates in Playbooks**

  Incorporate templates within playbooks using the `template` module:

  ```yaml
  - name: Create a configuration file
    template:
      src: myconfig.j2
      dest: /etc/network/interfaces
  ```

## Roles

Roles in Ansible help organize playbooks by grouping related tasks, variables, templates, and files together. This promotes reusability, modularity, and maintainability. Here's how to create and use roles:

  **Creating a Role**

  Organize your role-specific files inside a dedicated directory (e.g., `roles/my_role`) with the following structure:

  ```
  my_role/
    ├── tasks
    │   └── main.yml
    ├── vars
    │   └── main.yml
    ├── templates
    │       └── myconfig.j2
    └── handlers
        └── main.yml
  ```

  **Using Roles in Playbooks**

  Include roles within playbooks using the `roles` key:

  ```yaml
  - hosts: all
    roles:
      - my_role

    tasks:
      - name: Ensure the user exists
        user:
          name: "{{ user_name }}"
          groups: "{{ user_group }}"
          state: present
  ```

By understanding and applying variables, templates, and roles in Ansible playbooks, you can create more flexible, maintainable, and reusable automation content. This knowledge forms a crucial part of mastering Ansible for effective system management and configuration tasks.