#  Setting up a simple Ansible environment

== Hands-on Lab: Basic Automation with Ansible
   = Setting up a Simple Ansible Environment

   This hands-on lab will guide you through setting up a basic Ansible environment, enabling you to automate simple system configurations and manage files. By following this activity, you'll gain practical experience in using Ansible as a configuration management tool.

   ### Prerequisites

   Before starting the lab, ensure that:

1. You have an understanding of Linux command line basics.
2. You have installed Git on your local machine for version control (optional but recommended).
3. You have an account with a cloud provider like AWS, Azure, or Google Cloud Platform (for creating virtual machines) or physical access to a few Linux servers (e.g., VirtualBox, VMware).

   ### Step 1: Prepare Managed Nodes

   For this lab, you need at least two Linux servers/virtual machines: one will act as the Control Node (Ansible server), and the other(s) will be Managed Nodes (target systems to automate).

   - **Control Node:** Install Ansible on your control node.

     ```bash
     sudo apt update
     sudo apt install ansible -y  # For Debian/Ubuntu based distributions
     # or

     sudo yum install ansible -y  # For RHEL/CentOS based distributions
     ```

   - **Managed Nodes:** Install the OpenSSH server package on each managed node to enable remote communication.

     ```bash
     sudo apt update
     sudo apt install openssh-server -y  # For Debian/Ubuntu based distributions
     # or

     sudo yum install openssh-server -y  # For RHEL/CentOS based distributions
     ```

   Ensure that firewalls allow SSH connections (e.g., using `ufw` for Ubuntu):

   ```bash
   sudo ufw allow ssh
   ```

   ### Step 2: Configure Inventories

   Create an inventory file named `inventory.ini` to list your managed nodes and their associated groups. Here's a simple example with one group called `webservers`:

   ```ini
   [webservers]
   node1 ansible_host=<node1_ip>  # Replace <node1_ip> with the actual IP address of your first managed node
   node2 ansible_host=<node2_ip>  # Replace <node2_ip> with the actual IP address of your second managed node
   ```

   Place this file in the `/etc/ansible` directory or a custom path specified by the `--inventory-file` option when running Ansible playbooks.

### Step 3: Test Connectivity

Test the connection to your managed nodes using the `ping` module to ensure Ansible can communicate with them. Run the following command on your control node:

```bash
ansible webservers -m ping
```

If you see output similar to the following, connectivity is established successfully:

```
node1 | success >> {
    "changed": false,
    "ping": "pong"
}
node2 | success >> {
    "changed": false,
    "ping": "pong"
}
```

### Step 4: Create Basic Playbooks

Create a simple Ansible playbook named `basic_playbook.yml` to demonstrate basic tasks such as installing the Apache web server and managing files.

```yaml
---
- hosts: webservers
  become: yes
  tasks:
    - name: Install apache2 package
      apt:
        name: apache2
        state: present

    - name: Copy index.html to /var/www/html
      copy:
        src: ./index.html
        dest: /var/www/html/index.html
```

Create an `index.html` file with some content in the same directory as your playbook:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ansible Lab</title>
</head>
<body>
    <h1>Welcome to our simple Ansible automation lab!</h1>
</body>
</html>
```

### Step 5: Execute Playbooks

Run the playbook using the following command on your control node:

```bash
ansible-playbook basic_playbook.yml
```

Monitor the output to ensure successful execution and observe that Apache is installed and the `index.html` file has been copied to each managed node.

### Conclusion

By completing this hands-on lab, you have successfully set up a simple Ansible environment, created an inventory, tested connectivity, and executed basic playbooks to automate system configuration tasks and manage files across multiple nodes. You can now explore more complex scenarios by adding roles, variables, and templates to your playbooks for enhanced automation capabilities.

Remember to clean up any resources you provisioned in the cloud provider or shut down virtual machines after finishing this lab to avoid unnecessary costs.