#  Managing files and services

= Managing Files and Services with Ansible
==========================================

Ansible excels at managing system configurations, including file and service management tasks. This section will guide you through essential techniques for handling files and services using Ansible Playbooks.

File Management Tasks
---------------------

Ansible provides powerful built-in modules to handle file operations, such as copying, removing, and modifying files efficiently. Here are some examples:

### Copying Files

To copy a local file to remote servers, use the `copy` module in your playbook.

```yaml
---
- name: Copy a configuration file
  hosts: managed_nodes
  tasks:
    - name: Copy config.conf from localhost to remote server
      copy:
        src: /etc/ansible/config.conf
        dest: /etc/myapp/config.conf
```

### Removing Files

To remove files on managed nodes, utilize the `file` module with the `state: absent` parameter.

```yaml
---
- name: Remove a file
  hosts: managed_nodes
  tasks:
    - name: Remove log.txt
      file:
        path: /var/log/my_app/log.txt
        state: absent
```

### Modifying Files

You can edit files using the `lineinfile` module, which allows you to add, replace, or delete lines within a file.

```yaml
---
- name: Ensure a specific line exists in a file
  hosts: managed_nodes
  tasks:
    - name: Insert a line into a file
      lineinfile:
        path: /etc/myapp/app.conf
        line: 'my_custom_option = some_value'
```

Service Management Tasks
------------------------

Ansible offers several modules to manage services effectively, ensuring they are running or stopped as required on your managed nodes. Some common service management tasks include starting, stopping, restarting, and enabling services.

### Starting a Service

To start a service using Ansible, use the `service` module with the `name` parameter set to the desired service name.

```yaml
---
- name: Start the my_app service
  hosts: managed_nodes
  tasks:
    - name: Ensure my_app is started
      service:
        name: my_app
        state: started
```

### Stopping a Service

To stop a service, set the `state` parameter to `stopped`.

```yaml
---
- name: Stop the my_app service
  hosts: managed_nodes
  tasks:
    - name: Ensure my_app is stopped
      service:
        name: my_app
        state: stopped
```

### Restarting a Service

To restart a service, set the `state` parameter to `restarted`.

```yaml
---
- name: Restart the my_app service
  hosts: managed_nodes
  tasks:
    - name: Ensure my_app is restarted
      service:
        name: my_app
        state: restarted
```

### Enabling a Service

To ensure that a service starts automatically at boot, use the `enabled` parameter.

```yaml
---
- name: Enable the my_app service
  hosts: managed_nodes
  tasks:
    - name: Ensure my_app is enabled
      service:
        name: my_app
        enabled: yes
```

These examples demonstrate basic file and service management with Ansible Playbooks. Remember, these are just starting points; you can extend and customize them based on your specific use cases. 

For further learning, consider experimenting with these tasks in a hands-on lab environment to gain practical experience managing files and services using Ansible.